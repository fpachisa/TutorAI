steps:
- name: 'gcr.io/cloud-builders/docker'
  args: [
    'build',
    '-t', 'asia-southeast1-docker.pkg.dev/ai-math-tutor-prod/web-repo/tutorai-web:v3',
    '-f', 'infra/production.Dockerfile',
    '--build-arg', 'NEXT_PUBLIC_FIREBASE_PROJECT_ID=ai-math-tutor-prod',
    '--build-arg', 'NEXT_PUBLIC_FIREBASE_API_KEY=dummy-key-for-build',
    '--build-arg', 'NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=ai-math-tutor-prod.firebaseapp.com',
    '--build-arg', 'NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=ai-math-tutor-prod.firebasestorage.app',
    '--build-arg', 'NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=739150684593',
    '--build-arg', 'NEXT_PUBLIC_FIREBASE_APP_ID=dummy-app-id-for-build',
    '.'
  ]
- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'asia-southeast1-docker.pkg.dev/ai-math-tutor-prod/web-repo/tutorai-web:v3']
timeout: 1200s